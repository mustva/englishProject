@using System.Globalization
@using System.ServiceModel
@using englishProject.Infrastructure
@using englishProject.Models
@using Newtonsoft.Json
@{
    ViewBag.Title = "levelExam";
    Layout = "~/Views/Shared/_LayoutExam.cshtml";

    Level level = ViewBag.level;
    Modul m = ViewBag.modul;
    HtmlString exam = null;

    switch (m)
    {
        case Modul.WordModul:
            exam = Html.HtmlConvertToJson((WordModul)ViewBag.exam);
            break;
        case Modul.PictureWordModul:
            exam = Html.HtmlConvertToJson((PictureWordModul)ViewBag.exam);
            break;
    }

}
@section scripts
{
    <script src="@Url.Content("~/Scripts/Modul/commonModul.js")"></script>
    <script src="@Url.Content("~/Scripts/Modul/" + m.ToString() + ".js")"></script>

    <script type="text/javascript">
        ko.bindingHandlers.executeOnEnter = {
            init: function (element, valueAccessor, allBindings, viewModel) {
                var callback = valueAccessor();
                $(element).keypress(function (event) {
                    var keyCode = (event.which ? event.which : event.keyCode);
                    if (keyCode === 13) {
                        callback.call(viewModel);
                        return false;
                    }
                    return true;
                });
            }
        }

        $(document).ready(function () {
            $("#loading").modal({ backdrop: false });
            var  vm = new viewmodel(@exam, @level.levelNumber, @level.kind, @level.boxNumber);

            ko.applyBindings(vm, document.getElementById("examWrapper"));

            $(window).load(function () {
                $("#loading").modal("hide");

            });

        });
    </script>
}
@Html.Partial("ModulPartial/LoadingPartial")

@Html.Partial("Modul/" + m.ToString())